<div style="display: flex; flex-direction: column; gap: 16px">
  <h2>Transações de {{ mesSelecionado | date : "MMMM" : "-03:00" : "pt-BR" | titlecase }}</h2>

  <div style="display: flex; justify-content: space-around; align-items: start">
    <div style="display: flex; flex-direction: column;">
      <button mat-fab extended (click)="abrirModal(undefined, ETipoTransacao.LIMITE_CREDITO)">
        <mat-icon>trending_up</mat-icon>
        <mat-icon>paid</mat-icon>
        Entrada
      </button>
      <table mat-table [dataSource]="receitas()">
        <ng-container matColumnDef="data">
          <th mat-header-cell *matHeaderCellDef> Data</th>
          <td mat-cell *matCellDef="let element"> {{ element.dataTransacao | date : 'dd/MM/yyyy' }}</td>
        </ng-container>

        <ng-container matColumnDef="valor">
          <th mat-header-cell *matHeaderCellDef> Valor</th>
          <td mat-cell *matCellDef="let element"> {{ element.valor | currency :'BRL' }}</td>
        </ng-container>

        <ng-container matColumnDef="descricao">
          <th mat-header-cell *matHeaderCellDef> Descrição</th>
          <td mat-cell *matCellDef="let element"> {{ element.descricao }}</td>
        </ng-container>

        <ng-container matColumnDef="carteira">
          <th mat-header-cell *matHeaderCellDef> Carteira</th>
          <td mat-cell *matCellDef="let element"> {{ element.tituloCarteira }}</td>
        </ng-container>
        <ng-container matColumnDef="categoria">
          <th mat-header-cell *matHeaderCellDef> Categoria</th>
          <td mat-cell *matCellDef="let element"> {{ element.tituloCategoria }}</td>
        </ng-container>

        <ng-container matColumnDef="acoes">
          <th mat-header-cell *matHeaderCellDef></th>
          <td mat-cell *matCellDef="let element">
            <div style="display: flex; justify-content: end">
              <button mat-icon-button (click)="abrirModal(element)">
                <mat-icon fontIcon="edit" />
              </button>
              <button mat-icon-button (click)="excluirGasto(element)">
                <mat-icon fontIcon="delete" />
              </button>
            </div>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="['data', 'valor', 'descricao', 'carteira', 'categoria', 'acoes']"></tr>
        <tr mat-row *matRowDef="let _; columns: ['data', 'valor', 'descricao', 'carteira', 'categoria', 'acoes'];"></tr>
      </table>
    </div>

    <div style="display: flex; flex-direction: column;">
      <button mat-fab extended (click)="abrirModal()">
        <mat-icon>trending_down</mat-icon>
        <mat-icon>paid</mat-icon>
        Saída
      </button>
      <table mat-table [dataSource]="despesas()">
        <ng-container matColumnDef="data">
          <th mat-header-cell *matHeaderCellDef> Data</th>
          <td mat-cell *matCellDef="let element"> {{ element.dataTransacao | date : 'dd/MM/y' }}</td>
        </ng-container>

        <ng-container matColumnDef="valor">
          <th mat-header-cell *matHeaderCellDef> Valor</th>
          <td mat-cell *matCellDef="let element"> {{ element.valor | currency : 'BRL' }}</td>
        </ng-container>

        <ng-container matColumnDef="descricao">
          <th mat-header-cell *matHeaderCellDef> Descrição</th>
          <td mat-cell *matCellDef="let element"> {{ element.descricao }}</td>
        </ng-container>

        <ng-container matColumnDef="carteira">
          <th mat-header-cell *matHeaderCellDef> Carteira</th>
          <td mat-cell *matCellDef="let element"> {{ element.tituloCarteira }}</td>
        </ng-container>
        <ng-container matColumnDef="categoria">
          <th mat-header-cell *matHeaderCellDef> Categoria</th>
          <td mat-cell *matCellDef="let element"> {{ element.tituloCategoria }}</td>
        </ng-container>

        <ng-container matColumnDef="acoes">
          <th mat-header-cell *matHeaderCellDef></th>
          <td mat-cell *matCellDef="let element">
            <div style="display: flex; justify-content: end">
              <button mat-icon-button (click)="abrirModal(element)">
                <mat-icon fontIcon="edit" />
              </button>
              <button mat-icon-button (click)="excluirGasto(element)">
                <mat-icon fontIcon="delete" />
              </button>
            </div>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="['data', 'valor', 'descricao', 'carteira', 'categoria', 'acoes']"></tr>
        <tr mat-row *matRowDef="let _; columns: ['data', 'valor', 'descricao', 'carteira', 'categoria', 'acoes'];"></tr>
      </table>
    </div>
  </div>
</div>

<ng-template #templateModalGasto>
  <h2 matDialogTitle>Nova Carteira</h2>

  <mat-dialog-content>
    <form [formGroup]="gastoForm" (ngSubmit)="salvarGasto()">
      <div style="display: flex; flex-direction: column">
        <div style="display: flex; justify-content: space-between; gap: 16px">
          <mat-form-field>
            <mat-label>Data da Transasação</mat-label>
            <input matInput [matDatepicker]="picker" required>
            <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
            <mat-datepicker #picker></mat-datepicker>
          </mat-form-field>

          <mat-form-field>
            <mat-label>Valor total</mat-label>
            <input matInput type="number" [formControl]="gastoForm.controls.valor" required />
          </mat-form-field>
        </div>

        <mat-form-field style="width: 100%">
          <mat-label>Descrição</mat-label>
          <input matInput placeholder="Ingresso do cinema" [formControl]="gastoForm.controls.descricao" required />
        </mat-form-field>

        <mat-chip-listbox [formControl]="gastoForm.controls.idCategoria">
          @for (item of categoriasOptions(); track item) {
            <mat-chip-option [value]="item.id"> {{ item.titulo }}</mat-chip-option>
          }
        </mat-chip-listbox>

        <mat-chip-listbox [formControl]="gastoForm.controls.idCarteira">
          @for (item of carteirasOptions(); track item) {
            <mat-chip-option [value]="item.id"> {{ item.titulo }}</mat-chip-option>
          }
        </mat-chip-listbox>
      </div>
    </form>
  </mat-dialog-content>

  <mat-dialog-actions>
    <button mat-flat-button matDialogClose>Cancelar</button>
    <button mat-flat-button (click)="salvarGasto()">Salvar</button>
  </mat-dialog-actions>
</ng-template>
